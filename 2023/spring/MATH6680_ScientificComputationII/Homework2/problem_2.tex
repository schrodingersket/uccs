\textbf{Trefethen 6.1}

If $x_0, x_1, \ldots, x_N \in \mathbb{R}$ are distinct, then the \textit{cardinal function $p_j(x)$} defined by 

$$
p_j(x) = \frac{1}{a_j} \prod\limits_{\substack{k=0 \\ k \neq j}}^{N}(x - x_k), \quad a_j = \prod\limits_{\substack{k=0 \\ k \neq j}}^{N}(x_j - x_k)
$$

is the unique polynomial interpolant of degree $N$ to the values 1 at $x_j$ and 0 at $x_k$, $k \neq j$. Take the 
logarithm and differentiate to obtain 

$$
p'_j(x) = p_j(x) \sum\limits_{\substack{k=0 \\ k \neq j}}^N \frac{1}{x - x_k},
$$

and from this derive the formulas

$$
D_{ij} = \frac{1}{a_j} \prod\limits_{\substack{k=0 \\ k \neq i,j}}^N (x_i - x_k) = \frac{a_i}{a_j(x_i - x_j)} \quad (i \neq j)
$$

and 

$$
D_{jj} = \sum\limits_{\substack{k=0 \\ k \neq j}}^N \frac{1}{x_j - x_k}.
$$

\begin{solution}
  We take the logarithm of $p_j(x)$ to find:

  \begin{align*}
    \ln{p_j(x)} &= \ln{\frac{1}{a_j} \prod\limits_{\substack{k=0 \\ k \neq j}}^{N} (x - x_k)} \\
                &= \left( \sum\limits_{\substack{k=0 \\ k \neq j}}^{N} \ln{(x - x_k)} \right) - \ln{a_j} 
  \end{align*}

  \pagebreak
  Taking the derivative yields:

  \begin{align*}
    \frac{p'_j(x)}{p_j(x)} &= \left[ \ln{p_j(x)} \right]_x  \\
                           &= \left[ \left( \sum\limits_{\substack{k=0 \\ k \neq j}}^{N} \ln{(x - x_k)} \right) - \ln{a_j} \right]_x \\
                           &= \sum\limits_{\substack{k=0 \\ k \neq j}}^{N} \frac{1}{(x - x_k)} \\
  \end{align*}

  and hence

  $$
    p'_j(x) = p_j(x) \sum\limits_{\substack{k=0 \\ k \neq j}}^N \frac{1}{x - x_k},
  $$

  as desired. To derive the desired formulas for $D_{ij}$, we evaluate $p'_j(x)$ at $x = x_i$ where $i \neq j$:

  $$
    p'_j(x_i) = \frac{1}{a_j} \prod\limits_{\substack{k=0 \\ k \neq j}}^{N}(x_i - x_k) \sum\limits_{\substack{m=0 \\ m \neq j}}^N \frac{1}{x_i - x_m} \\
  $$

  We note that product contains a zero term when $k = i$, and so each sum term with $m \neq i$ is zero. When 
  $m = k = i$, $x_i - x_k$ and $(x_i - x_m)^{-1}$ cancel and we obtain

  $$
    p'_j(x_i) = \frac{1}{a_j} \prod\limits_{\substack{k=0 \\ k \neq i,j}}^{N}(x_i - x_k).
  $$

  Similarly, we evaluate $p'(x_j)$ to find:

  $$
    p'_j(x_j) = \frac{1}{a_j} \prod\limits_{\substack{k=0 \\ k \neq j}}^{N}(x_j - x_k) \sum\limits_{\substack{m=0 \\ m \neq j}}^N \frac{1}{x_j - x_m} \\
              = \frac{1}{a_j} a_j \sum\limits_{\substack{m=0 \\ m \neq j}}^N \frac{1}{x_j - x_m} \\
              = \sum\limits_{\substack{m=0 \\ m \neq j}}^N \frac{1}{x_j - x_m}
  $$

  as desired.

\end{solution}